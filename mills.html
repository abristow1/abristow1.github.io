<!DOCTYPE html>

<html>

<head>
   <link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.1/dist/leaflet.css" />
   <style>
     body {
      padding: 0;
      margin: 0;
      }
     html, body, #mapid {
       height: 100%;
       width: 100%;
     }
   </style>
</head>

<body>
   
     <!-- JS -->
     <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
     <script src="https://unpkg.com/leaflet@1.0.1/dist/leaflet.js"></script>
     <script src="segments.geojson"></script>
     <script src="https://unpkg.com/esri-leaflet@2.0.4"></script>
     <script src="https://rawgithub.com/mylen/leaflet.TileLayer.WMTS/master/leaflet-tilelayer-wmts.js"></script>
     <script src='//api.tiles.mapbox.com/mapbox.js/plugins/leaflet-omnivore/v0.3.1/leaflet-omnivore.min.js'></script>

  <div id="mapid"></div>

  <script>
    var mymap = L.map('mapid').setView([34.605972, -92.484339], 18);
     
    var imagery = L.esri.basemapLayer('Imagery').addTo(mymap);
    var imageryLabels = L.esri.basemapLayer('ImageryLabels').addTo(mymap);
    var dem = L.esri.dynamicMapLayer({url: "https://www.efsedge.com/arcgis/rest/services/Saline_County/Saline_DEM/MapServer"});
         
     /*Building Footprints*/
     var building_footprints = L.esri.featureLayer({
      onEachFeature: function (feature, layer)
      {
        layer.bindPopup("Parcel ID: " + feature.properties.parcel_id)
      },
      url: 'http://www.efsedge.com/arcgis/rest/services/Saline_County/Vector2/MapServer/21',
      style: {
        color: '#F2F3F4',
        weight: 2
      }
    });

/* Parcels */
var parcelsLayer = L.geoJson(null);
var parcels = L.geoJson(null, {
  

style: function (feature) {
  return {
    weight: 1,
    opacity: 1,
    color: '#F3C300',
    fillColor: 'black',
    fillOpacity: 0.2
  };
},
	

  
  onEachFeature: function (feature, layer) {
    if (feature.properties) {
      var parcelsContent = "<table class='table table-striped table-bordered table-condensed'>" + 
				"<tr><th>Owner Name</th><td>" + feature.properties.ow_name + "</td></tr>" 
				+ "<tr><th>Owner Source Date</th><td>" + feature.properties.ow_src_dat + "</td></tr>" 
				+ "<tr><th>Parcel ID</th><td>" + feature.properties.parcel_id + "</td></tr>" 
				+ "<table>";
      layer.on({
        click: function (e) {
          layer.bindPopup(parcelsContent);
        }
      });

    }
    layer.on({
      mouseover: function (e) {
        var layer = e.target;
        layer.setStyle({
          weight: 2,
          fillOpacity: 0.8,
          dashArray: '10, 5'
        });
        if (!L.Browser.ie && !L.Browser.opera) {
          layer.bringToFront();
        }
      },
      mouseout: function (e) {
        parcels.resetStyle(e.target);
      }
    });    
  }
});
$.getJSON("parcels.geojson", function (data) {
  parcels.addData(data);
});

/* Points */
var geojsonMarkerOptions = {
    radius: 8,
    fillColor: "#ff7800",
    color: "#000",
    weight: 1,
    opacity: 1,
    fillOpacity: 0.8
};

L.geoJSON(segments, {
    pointToLayer: function (feature, latlng) {
        return L.circleMarker(latlng, geojsonMarkerOptions);
    }
}).addTo(mymap);

/*Elevation overlay*/	  
var imageUrl = "dem.bmp",
    imageBounds = [[34.6101, -92.4902], [34.6016, -92.4779]];
	
var elevation = L.imageOverlay(imageUrl, imageBounds);
     
    
    /*Layer Control*/ 
    var runLayer = omnivore.kml('bare_earth.kml');
    var baseMaps = {
      "Imagery": imagery,
      "DEM": dem,
      "Elevation": elevation
    };
    var overlayMaps = {
      "Buildings": building_footprints,
      "Parcels": parcels
    };
    L.control.layers(baseMaps, overlayMaps, {
      collapsed: true
    }).addTo(mymap);
	  
     
    
  </script>
   
</body>
</html>
